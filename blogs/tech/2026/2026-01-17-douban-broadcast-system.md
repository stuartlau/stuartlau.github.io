---
layout: post
title: è±†ç“£å¹¿æ’­ç³»ç»Ÿè®¾è®¡ä¸å®ç°
date: 2026-01-17
subtitle: æ•°æ®èšåˆä¸Feedæµç³»ç»Ÿçš„æŠ€æœ¯å®è·µ
tags: [æ¶æ„, åç«¯, æ•°æ®å¤„ç†, Feedç³»ç»Ÿ]
---

## å‰è¨€

æœ¬æ–‡ä»‹ç»è±†ç“£å¹¿æ’­ï¼ˆBroadcastï¼‰æ•°æ®ç³»ç»Ÿçš„è®¾è®¡ä¸å®ç°ï¼ŒåŒ…æ‹¬æ•°æ®é‡‡é›†ã€å­˜å‚¨ã€APIè®¾è®¡å’Œå‰ç«¯å±•ç¤ºçš„å®Œæ•´æµç¨‹ã€‚é€šè¿‡è¯¥ç³»ç»Ÿï¼Œæˆ‘ä»¬å°†åˆ†æ•£åœ¨ä¸åŒå¹´ä»½çš„è±†ç“£å¹¿æ’­æ•°æ®æ•´åˆåˆ°ç»Ÿä¸€çš„é¡µé¢ä¸­å±•ç¤ºã€‚

## ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### æ•´ä½“æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·è®¿é—®å±‚                                    â”‚
â”‚              (æµè§ˆå™¨ â†’ GitHub Pages â†’ é™æ€é¡µé¢)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         APIæ¥å£å±‚                                     â”‚
â”‚              (Jekyll Layouts â†’ Data Files â†’ JSON)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         æ•°æ®å¤„ç†å±‚                                    â”‚
â”‚         (Pythonè„šæœ¬ â†’ JSONæ¸…æ´— â†’ æŒ‰å¹´ä»½åˆ†ç»„ â†’ ç»Ÿè®¡æ±‡æ€»)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         æ•°æ®æºå±‚                                      â”‚
â”‚        (è±†ç“£ç½‘é¡µ â†’ æ‰‹åŠ¨å¯¼å‡º â†’ æ¸…æ´—å¤„ç† â†’ ç»“æ„åŒ–å­˜å‚¨)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµè½¬å›¾

```mermaid
flowchart LR
    subgraph åŸå§‹æ•°æ®
        A[è±†ç“£ç½‘é¡µ] --> B[æ‰‹åŠ¨å¤åˆ¶/å¯¼å‡º]
    end
    
    subgraph æ•°æ®å¤„ç†
        B --> C[Pythonæ¸…æ´—è„šæœ¬]
        C --> D[JSONæ ¼å¼åŒ–]
        D --> E[æŒ‰å¹´ä»½åˆ†ç»„]
    end
    
    subgraph æ•°æ®å­˜å‚¨
        E --> F[_data/douban/]
        F --> G[2021.json]
        F --> H[2022.json]
        F --> I[2023.json]
        F --> J[2024.json]
        F --> K[2025.json]
        F --> L[2026.json]
    end
    
    subgraph å‰ç«¯å±•ç¤º
        M[douban.html] --> N[å¹´ä»½é€‰æ‹©å™¨]
        M --> O[Feedåˆ—è¡¨]
        M --> P[è¯„è®ºé›†æˆ]
    end
    
    G --> M
    H --> M
    I --> M
    J --> M
    K --> M
    L --> M
```

## é¡µé¢å±•ç¤ºæ•ˆæœ

> ğŸ“¸ **æˆªå›¾ä½ç½®**ï¼šè¯·åœ¨æ­¤å¤„æ’å…¥è±†ç“£å¹¿æ’­é¡µé¢æˆªå›¾
> 
> ![Douban Broadcast Page](/images/screenshots/douban-broadcast.png)

å¦‚å›¾æ‰€ç¤ºï¼Œé¡µé¢åŒ…å«ï¼š
- å·¦ä¾§ç”¨æˆ·å¤´åƒå’Œç»Ÿè®¡ä¿¡æ¯
- ä¸­é—´Feedæµå±•ç¤ºåŒº
- å³ä¾§å¹´ä»½å¯¼èˆªå’Œçƒ­é—¨å¹´ä»½æç¤º

## æ•°æ®ç»“æ„è®¾è®¡

### å¹¿æ’­æ•°æ®æ¨¡å‹

```yaml
# _data/douban/2026.json ç¤ºä¾‹
- time: "2026-01-12 20:30:45"
  content: "åˆ†äº«ä¸€æ®µæ—¥å¸¸ç”Ÿæ´»è®°å½•"
  images:
    - "https://img9.doubanio.com/view/photo/s/public/p1.jpg"
    - "https://img9.doubanio.com/view/photo/s/public/p2.jpg"
  my_rating: 5          # å¯é€‰ï¼Œ1-5åˆ†
  video_url: ""         # å¯é€‰ï¼Œè§†é¢‘é“¾æ¥
  interact_info:        # äº’åŠ¨æ•°æ®
    liked_count: 42
    comment_count: 5
    forward_count: 3
```

### æ•°æ®å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `time` | String | å‘å¸ƒæ—¶é—´ï¼Œæ ¼å¼ï¼š`YYYY-MM-DD HH:mm:ss` |
| `content` | String | å¹¿æ’­æ–‡æœ¬å†…å®¹ |
| `images` | Array | å›¾ç‰‡URLåˆ—è¡¨ï¼Œæ”¯æŒå¤šå›¾ |
| `my_rating` | Integer | ä¸ªäººè¯„åˆ†ï¼ˆ1-5ï¼‰ï¼Œä»…é™è¯»ä¹¦/ç”µå½±/æ¸¸æˆæ ‡è®° |
| `video_url` | String | è§†é¢‘é“¾æ¥ï¼ˆå¯é€‰ï¼‰ |
| `interact_info` | Object | äº’åŠ¨ç»Ÿè®¡æ•°æ® |

### å¹´ä»½æ±‡æ€»ç»Ÿè®¡

```json
// _data/douban_summaries.json
{
  "2026": {
    "count": 156,
    "with_images": 89,
    "with_videos": 12,
    "avg_rating": 4.2,
    "top_topics": ["æ—…è¡Œ", "ç¾é£Ÿ", "æ—¥å¸¸ç”Ÿæ´»"]
  },
  "2025": {
    "count": 203,
    "with_images": 134,
    "with_videos": 18,
    "avg_rating": 4.0,
    "top_topics": ["è‚²å„¿", "æŠ€æœ¯", "æ—…è¡Œ"]
  }
}
```

## å‰ç«¯å®ç°

### é¡µé¢å¸ƒå±€ç»“æ„

```html
<div class="douban-container">
    <!-- å·¦ä¾§è¾¹æ  -->
    <aside class="douban-sidebar">
        <div class="user-info">
            <img src="/images/douban_avatar.jpg" class="avatar" />
            <h2>Stuart Lau</h2>
            <p class="nickname">@stuartlau</p>
        </div>
        <div class="stats">
            <div class="stat-item">
                <span class="stat-value">1200+</span>
                <span class="stat-label">å¹¿æ’­</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">50+</span>
                <span class="stat-label">ä¹¦ç±</span>
            </div>
        </div>
    </aside>
    
    <!-- ä¸»å†…å®¹åŒº -->
    <main class="douban-main">
        <!-- å¹´ä»½é€‰æ‹©å™¨ -->
        <nav class="year-tabs">
            <a href="#2026" class="year-tab active">2026</a>
            <a href="#2025" class="year-tab">2025</a>
            ...
        </nav>
        
        <!-- Feedåˆ—è¡¨ -->
        <div class="feed-list">
            <!-- å¹¿æ’­æ¡ç›® -->
        </div>
    </main>
</div>
```

### å¹¿æ’­æ¡ç›®ç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·å¤´åƒ    @stuartlau        3Day 3h                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  è¿™æ˜¯å¹¿æ’­çš„æ–‡å­—å†…å®¹ï¼Œå¯èƒ½å¾ˆé•¿ï¼Œå¯èƒ½åŒ…å«å¤šè¡Œ                 â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                                     â”‚
â”‚  â”‚å›¾1 â”‚ â”‚å›¾2 â”‚ â”‚å›¾3 â”‚  å›¾ç‰‡ç½‘æ ¼å±•ç¤º                        â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¬ ...  ğŸ”– ...  â¤ï¸ ...           ç‚¹å‡»å±•å¼€è¯„è®º             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›¸å¯¹æ—¶é—´æ ¼å¼åŒ–

```javascript
function formatTime(timeStr) {
    const now = new Date();
    const statusDate = new Date(timeStr.replace(' ', 'T'));
    const diffMs = now - statusDate;
    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
    const diffMinutes = Math.floor(diffMs / (1000 * 60));

    if (diffDays < 7 && diffDays >= 0) {
        if (diffDays > 0) {
            return `${diffDays}Day ${diffHours % 24}h`;
        } else if (diffHours > 0) {
            return `${diffHours}h ${diffMinutes % 60}m`;
        } else {
            return `${diffMinutes}m`;
        }
    } else {
        // è¶…è¿‡7å¤©æ˜¾ç¤ºå…·ä½“æ—¥æœŸ
        const year = statusDate.getFullYear();
        const month = String(statusDate.getMonth() + 1).padStart(2, '0');
        const day = String(statusDate.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    }
}
```

### å¹´ä»½ç­›é€‰é€»è¾‘

```javascript
// ä½¿ç”¨dataå±æ€§å­˜å‚¨å¹´ä»½ä¿¡æ¯
document.querySelectorAll('.douban-status-item').forEach(item => {
    const itemYear = item.dataset.year;
    const targetYear = getCurrentYearFromHash();
    
    if (itemYear === targetYear || targetYear === 'all') {
        item.style.display = '';
    } else {
        item.style.display = 'none';
    }
});

// ç®€åŒ–ï¼šç›´æ¥é“¾æ¥åˆ°ä¸åŒé¡µé¢
// /douban/2026.html, /douban/2025.html, ...
```

## è¯„è®ºç³»ç»Ÿé›†æˆ

### Giscusé›†æˆ

```html
<!-- ä½¿ç”¨Giscuså®ç°GitHub Discussionsè¯„è®º -->
<script 
    src="https://giscus.app/client.js"
    data-repo="stuartlau/stuartlau.github.io"
    data-repo-id="xxx"
    data-category="Announcements"
    data-category-id="xxx"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="light"
    data-lang="zh-CN"
    crossorigin="anonymous"
    async>
</script>
```

### è¯„è®ºåŠ¨æ€åŠ è½½

```javascript
function toggleGiscus(element) {
    const wrapper = element.closest('.douban-status-item')
                       .nextElementSibling
                       .querySelector('.giscus-wrapper');
    
    if (wrapper.style.display === 'none') {
        wrapper.style.display = 'block';
        // Giscusè‡ªåŠ¨åŠ è½½
        if (typeof giscus !== 'undefined') {
            giscus.configure();
        }
    } else {
        wrapper.style.display = 'none';
    }
}
```

## æ•°æ®ç»Ÿè®¡ä¸å¯è§†åŒ–

### å¹´åº¦æ•°æ®ç»Ÿè®¡

```mermaid
graph LR
    A[åŸå§‹æ•°æ®] --> B[æ•°æ®æ¸…æ´—]
    B --> C[ç»Ÿè®¡è®¡ç®—]
    C --> D[å¯è§†åŒ–å±•ç¤º]
    
    subgraph ç»Ÿè®¡ç»´åº¦
        E[æ€»æ•°ç»Ÿè®¡]
        F[å›¾ç‰‡å æ¯”]
        G[è¯„åˆ†åˆ†å¸ƒ]
        H[æœˆä»½åˆ†å¸ƒ]
        I[äº’åŠ¨æ’è¡Œ]
    end
    
    C --> E
    C --> F
    C --> G
    C --> H
    C --> I
    
    D --> J[æŸ±çŠ¶å›¾]
    D --> K[é¥¼å›¾]
    D --> L[æ—¶é—´çº¿]
```

### ç»Ÿè®¡å±•ç¤ºæ•ˆæœ

> ğŸ“¸ **æˆªå›¾ä½ç½®**ï¼šè¯·åœ¨æ­¤å¤„æ’å…¥ç»Ÿè®¡å¡ç‰‡æˆªå›¾
> 
> ![Douban Stats](/images/screenshots/douban-stats.png)

## å›¾ç‰‡å¤„ç†ä¼˜åŒ–

### å›¾ç‰‡ç½‘æ ¼å¸ƒå±€

```css
.status-images {
    display: flex;
    gap: 8px;
    margin-top: 12px;
}

.status-image-thumb {
    width: 120px;
    height: 120px;
    background-size: cover;
    background-position: center;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.2s;
}

.status-image-thumb:hover {
    transform: scale(1.05);
}
```

### ç¯ç®±æ•ˆæœ

```javascript
function openLightbox(imageUrl, allImages) {
    currentImages = allImages;
    currentImageIndex = currentImages.indexOf(imageUrl);
    
    const lb = document.getElementById('lightbox');
    document.getElementById('lightbox-img').src = imageUrl;
    lb.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

// é”®ç›˜å¯¼èˆª
document.addEventListener('keydown', function(e) {
    const lb = document.getElementById('lightbox');
    if (lb.style.display === 'flex') {
        if (e.key === 'ArrowRight') nextLightboxImage();
        if (e.key === 'ArrowLeft') prevLightboxImage();
        if (e.key === 'Escape') closeLightbox();
    }
});
```

## æ•°æ®ç»´æŠ¤æµç¨‹

### æ·»åŠ æ–°å¹¿æ’­çš„æµç¨‹

```mermaid
flowchart TD
    A[åœ¨è±†ç“£å‘å¸ƒæ–°å¹¿æ’­] --> B[å®šæœŸå¯¼å‡ºæ•°æ®]
    B --> C[è¿è¡Œæ¸…æ´—è„šæœ¬]
    C --> D[æ›´æ–°å¯¹åº”å¹´ä»½JSON]
    D --> E[æœ¬åœ°éªŒè¯]
    E --> F[æäº¤ä»£ç ]
    F --> G[è‡ªåŠ¨éƒ¨ç½²]
    G --> H[çº¿ä¸Šç”Ÿæ•ˆ]
```

### æ¸…æ´—è„šæœ¬ç¤ºä¾‹

```python
import json
import re
from datetime import datetime

def clean_douban_data(raw_text):
    """æ¸…æ´—è±†ç“£åŸå§‹æ•°æ®"""
    records = []
    
    for line in raw_text.strip().split('\n'):
        if not line.strip():
            continue
            
        # è§£ææ—¶é—´
        time_match = re.search(r'(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})', line)
        if time_match:
            time_str = time_match.group(1)
            
            # æå–å†…å®¹ï¼ˆå»é™¤æ—¶é—´å’Œç‰¹æ®Šå­—ç¬¦ï¼‰
            content = re.sub(r'\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\]', '', line)
            content = content.strip()
            
            records.append({
                'time': time_str,
                'content': content,
                'images': extract_images(content),
                'interact_info': {
                    'liked_count': '0',
                    'comment_count': '0'
                }
            })
    
    return records

def group_by_year(records):
    """æŒ‰å¹´ä»½åˆ†ç»„"""
    grouped = {}
    for record in records:
        year = record['time'][:4]
        if year not in grouped:
            grouped[year] = []
        grouped[year].append(record)
    
    return grouped
```

## æ€»ç»“

æœ¬æ–‡ä»‹ç»äº†è±†ç“£å¹¿æ’­æ•°æ®ç³»ç»Ÿçš„å®Œæ•´å®ç°ï¼š

| æ¨¡å— | æŠ€æœ¯æ–¹æ¡ˆ |
|------|---------|
| æ•°æ®é‡‡é›† | æ‰‹åŠ¨å¯¼å‡º + Pythonæ¸…æ´— |
| æ•°æ®å­˜å‚¨ | Jekyll Data Filesï¼ˆYAML/JSONï¼‰ |
| é¡µé¢ç”Ÿæˆ | Jekyll Layouts + Liquidæ¨¡æ¿ |
| äº¤äº’åŠŸèƒ½ | Vanilla JSï¼ˆTabåˆ‡æ¢ã€ç¯ç®±ï¼‰ |
| è¯„è®ºç³»ç»Ÿ | Giscusï¼ˆGitHub Discussionsï¼‰ |
| éƒ¨ç½²æ–¹å¼ | GitHub Pagesè‡ªåŠ¨éƒ¨ç½² |

è¯¥ç³»ç»Ÿå……åˆ†åˆ©ç”¨äº†é™æ€ç«™ç‚¹çš„ä¼˜åŠ¿ï¼Œå®ç°äº†ä½è¿ç»´æˆæœ¬çš„æ•°æ®èšåˆå±•ç¤ºã€‚
